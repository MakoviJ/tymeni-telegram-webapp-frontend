<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∏ - –ú–µ–Ω—ñ, –Ø - —Ç–æ–±—ñ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            text-align: center;
            padding: 20px;
            background-color: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #222222);
        }
        h1 {
            margin-top: 30px;
            color: var(--tg-theme-text-color, #222222);
        }
        .btn {
            display: block;
            width: 80%;
            margin: 15px auto;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            background-color: var(--tg-theme-button-color, #40a7e3);
            color: var(--tg-theme-button-text-color, #ffffff);
            cursor: pointer;
        }
        /* –°—Ç–∏–ª—ñ –¥–ª—è —Ñ–æ—Ä–º–∏ */
        #create-form {
            display: none;
            margin: 20px auto;
            max-width: 400px;
        }
        #create-form input, 
        #create-form textarea, 
        #create-form select {
            width: 80%;
            padding: 10px;
            margin: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-family: inherit;
        }
        #create-form textarea {
            height: 60px;
            resize: vertical;
        }
        .form-group {
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üíôüíõ –¢–∏ - –ú–µ–Ω—ñ, –Ø - —Ç–æ–±—ñ üíôüíõ</h1>
    <p>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø–æ—Å–ª—É–≥ –°–≤–æ—ó –¥–ª—è –°–≤–æ—ó—Ö</p>

    <button class="btn" onclick="alert('–¶–µ–π —Ä–æ–∑–¥—ñ–ª —â–µ –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ!')">üîç –ó–Ω–∞–π—Ç–∏ –ø–æ—Å–ª—É–≥—É</button>

    <div id="create-form">
        <h3>–°—Ç–≤–æ—Ä–∏—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è</h3>
        <form id="service-form">
            <div class="form-group">
                <input type="text" id="title" placeholder="–ù–∞–∑–≤–∞ –ø–æ—Å–ª—É–≥–∏" required>
            </div>
            
            <div class="form-group">
                <textarea id="description" placeholder="–û–ø–∏—Å –ø–æ—Å–ª—É–≥–∏"></textarea>
            </div>
            
            <div class="form-group">
                <select id="category" required onchange="updateSubcategories(); toggleSuggestedCategory();">
                    <option value="">–û–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</option>
                    </select>
            </div>
            
            <div class="form-group">
                <select id="subcategory" style="display: none;" required>
                    <option value="">–û–±–µ—Ä—ñ—Ç—å –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—é</option>
                    </select>
            </div>
            
            <div class="form-group">
                <input type="text" id="user_suggested_category" placeholder="–ê–±–æ –∑–∞–ø—Ä–æ–ø–æ–Ω—É–π—Ç–µ –Ω–æ–≤—É –∫–∞—Ç–µ–≥–æ—Ä—ñ—é" 
                        style="display: none; width: 80%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
            </div>
            
            <button type="submit" class="btn">–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏</button>
        </form>
    </div>

    <button class="btn" id="show-form-btn">‚ú® –ó–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ –ø–æ—Å–ª—É–≥—É</button>
    <button class="btn" onclick="alert('–¶–µ–π —Ä–æ–∑–¥—ñ–ª —â–µ –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ!')">üìû –ú–æ—è –∞–Ω–∫–µ—Ç–∞</button>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω–∞ –∑–º—ñ–Ω–Ω–∞ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–π
        let categoriesData = {};
        
        // ========= –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø #1: –í–∏–Ω–µ—Å–µ–Ω–æ –ª–æ–≥—ñ–∫—É –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ–π –æ–∫—Ä–µ–º–æ =========
        // –¢–µ–ø–µ—Ä —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≥–ª–æ–±–∞–ª—å–Ω—É –∑–º—ñ–Ω–Ω—É `categoriesData`
        function updateSubcategories() {
            const categorySelect = document.getElementById('category');
            const subcategorySelect = document.getElementById('subcategory');
            const categoryKey = categorySelect.value;
            
            // –û—á–∏—â–∞—î–º–æ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
            subcategorySelect.innerHTML = '<option value="">–û–±–µ—Ä—ñ—Ç—å –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—é</option>';
            
            if (categoryKey && categoryKey !== 'other' && categoriesData[categoryKey]) {
                // –î–æ–¥–∞—î–º–æ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –¥–ª—è –æ–±—Ä–∞–Ω–æ—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
                categoriesData[categoryKey].subcategories.forEach(sub => {
                    const option = document.createElement('option');
                    option.value = sub;
                    option.textContent = sub;
                    subcategorySelect.appendChild(option);
                });
                subcategorySelect.style.display = 'block';
                subcategorySelect.setAttribute('required', 'true');
            } else {
                subcategorySelect.style.display = 'none';
                subcategorySelect.removeAttribute('required');
            }
            
            toggleSuggestedCategory();
        }

        // ====== –û–°–ù–û–í–ù–ê –õ–û–ì–Ü–ö–ê –î–û–î–ê–¢–ö–£ ======
        
        // 1. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.expand(); // –†–æ–∑–≥–æ—Ä–Ω—É—Ç–∏ –Ω–∞ –≤–µ—Å—å –µ–∫—Ä–∞–Ω
        tg.enableClosingConfirmation(); // –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç—Ç—è
        tg.MainButton.setText("–ì–æ—Ç–æ–≤–æ").show(); // –ì–æ–ª–æ–≤–Ω–∞ –∫–Ω–æ–ø–∫–∞
        tg.MainButton.onClick(() => tg.close());

        // 2. –î–∞–Ω—ñ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤—ñ–¥ Telegram
        const initData = Telegram.WebApp.initData;
        console.log("Telegram user data:", initData);

        // 3. –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ–∫–∞–∑—É —Ñ–æ—Ä–º–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è
        function showCreateForm() {
            document.getElementById('create-form').style.display = 'block';
        }

        // ========= –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø #2: –î–æ–¥–∞–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä—ñ–π =========
        // –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –∑–∞–ø–æ–≤–Ω—é—î –≤–∏–ø–∞–¥–∞—é—á–∏–π —Å–ø–∏—Å–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –æ—Ç—Ä–∏–º–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö
        function updateCategoryDropdown() {
            const categorySelect = document.getElementById('category');
            console.log('–û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä—ñ–π...');
            
            // –û—á–∏—â–∞—î–º–æ –í–°–Ü –æ–ø—Ü—ñ—ó, –≤–∫–ª—é—á–∞—é—á–∏ –ø–µ—Ä—à—É
            categorySelect.innerHTML = '<option value="">–û–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</option>';
            
            // –î–æ–¥–∞—î–º–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –∑ —Å–µ—Ä–≤–µ—Ä–Ω–∏—Ö –¥–∞–Ω–∏—Ö
            for (const [key, category] of Object.entries(categoriesData)) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = category.name;
                categorySelect.appendChild(option);
                console.log('–î–æ–¥–∞–Ω–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é:', key, category.name);
            }
            
            // –î–æ–¥–∞—î–º–æ –æ–ø—Ü—ñ—é "–Ü–Ω—à–µ" –≤ –∫—ñ–Ω–µ—Ü—å
            const otherOption = document.createElement('option');
            otherOption.value = 'other';
            otherOption.textContent = '‚ú® –†—ñ–∑–Ω—ñ –ø–æ—Å–ª—É–≥–∏';
            categorySelect.appendChild(otherOption);
            
            console.log('–°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π –æ–Ω–æ–≤–ª–µ–Ω–æ. –í—Å—å–æ–≥–æ –æ–ø—Ü—ñ–π:', categorySelect.options.length);
        }

        // 5. –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –ø–æ–ª—è –Ω–æ–≤–æ—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
        function toggleSuggestedCategory() {
            const categorySelect = document.getElementById('category');
            const suggestedInput = document.getElementById('user_suggested_category');
            const subcategorySelect = document.getElementById('subcategory');
            
            if (categorySelect.value === 'other') {
                suggestedInput.style.display = 'block';
                suggestedInput.setAttribute('required', 'true');
                subcategorySelect.style.display = 'none';
                subcategorySelect.removeAttribute('required');
            } else {
                suggestedInput.style.display = 'none';
                suggestedInput.removeAttribute('required');
                if (categorySelect.value && categorySelect.value !== 'other') {
                    subcategorySelect.style.display = 'block';
                    subcategorySelect.setAttribute('required', 'true');
                }
            }
        }

        // 6. –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è
        async function createService(event) {
            event.preventDefault();
            
            const title = document.getElementById('title').value;
            const description = document.getElementById('description').value;
            const category = document.getElementById('category').value;
            const subcategory = document.getElementById('subcategory').value;
            const user_suggested_category = document.getElementById('user_suggested_category').value;
            
            // –í–∞–ª—ñ–¥–∞—Ü—ñ—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –ø–æ–ª—ñ–≤
            if (!title || !category) {
                alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –æ–±–æ–≤ º—è–∑–∫–æ–≤—ñ –ø–æ–ª—è: –Ω–∞–∑–≤–∞ —Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è');
                return;
            }
            
            // –°–ø–µ—Ü—ñ–∞–ª—å–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó "—ñ–Ω—à–µ"
            if (category === 'other' && !user_suggested_category) {
                alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø—Ä–æ–ø–æ–Ω—É–π—Ç–µ –Ω–∞–∑–≤—É –Ω–æ–≤–æ—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó');
                return;
            }
            
            // –î–ª—è –∑–≤–∏—á–∞–π–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
            if (category !== 'other' && !subcategory) {
                alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–µ—Ä—ñ—Ç—å –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—é');
                return;
            }
            
            // –ì–æ—Ç—É—î–º–æ –¥–∞–Ω—ñ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏
            const formData = {
                title: title,
                description: description,
                category: category,
                initData: initData
            };
            
            // –î–æ–¥–∞—î–º–æ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—é –∞–±–æ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω—É –∫–∞—Ç–µ–≥–æ—Ä—ñ—é –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –≤–∏–±–æ—Ä—É
            if (category === 'other') {
                formData.subcategory = '–Ü–Ω—à–µ';
                formData.user_suggested_category = user_suggested_category;
            } else {
                formData.subcategory = subcategory;
            }
            
            try {
                const response = await fetch('https://tymeni-telegram-webapp-frontend.pages.dev/api/services', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.details || `–ü–æ–º–∏–ª–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${response.status}`);
                }
                
                const result = await response.json();
                console.log('–£—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ:', result);
                alert('–û–≥–æ–ª–æ—à–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–æ! üéâ');
                
                // –û—á–∏—â–∞—î–º–æ —Ñ–æ—Ä–º—É —Ç–∞ —Ö–æ–≤–∞—î–º–æ —ó—ó
                document.getElementById('service-form').reset();
                document.getElementById('create-form').style.display = 'none';
                
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ:', error);
                alert('–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞: ' + error.message);
            }
        }

        // ========= –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø #3: –£—Ç–æ—á–Ω–µ–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—é loadCategories() =========
        // –¶—è —Ñ—É–Ω–∫—Ü—ñ—è —Ç–µ–ø–µ—Ä –æ–±—Ä–æ–±–ª—è—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å —ñ –≤–∏–∫–ª–∏–∫–∞—î updateCategoryDropdown()
        async function loadCategories() {
            try {
                console.log('–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–π...');
                const response = await fetch('https://tymeni-telegram-webapp-frontend.pages.dev/api/categories');
                
                if (!response.ok) {
                    throw new Error(`HTTP –ø–æ–º–∏–ª–∫–∞: ${response.status}`);
                }
                
                categoriesData = await response.json();
                console.log('–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ:', categoriesData);
                
                // –û–Ω–æ–≤–ª—é—î–º–æ –≤–∏–ø–∞–¥–∞—é—á–∏–π —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
                updateCategoryDropdown();
                
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–π:', error);
                // Fallback - –º–æ–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç–∏ —Å—Ç–∞—Ç–∏—á–Ω–∏–π —Å–ø–∏—Å–æ–∫ —è–∫ —Ä–µ–∑–µ—Ä–≤–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç
                showStaticCategories();
            }
        }

        // 8. –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –æ–≥–æ–ª–æ—à–µ–Ω—å
        async function loadServices() {
            try {
                const response = await fetch('https://tymeni-telegram-webapp-frontend.pages.dev/api/services');
                if (!response.ok) {
                    throw new Error(`HTTP error: ${response.status}`);
                }
                const services = await response.json();
                console.log('–û—Ç—Ä–∏–º–∞–Ω—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è:', services);
                // –¢—É—Ç –±—É–¥–µ –ª–æ–≥—ñ–∫–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –æ–≥–æ–ª–æ—à–µ–Ω—å –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:', error);
            }
        }

        // 9. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DOM
        document.addEventListener('DOMContentLoaded', function() {
            // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è —Ñ–æ—Ä–º–∏
            const form = document.getElementById('service-form');
            if (form) {
                form.addEventListener('submit', createService);
            }
            
            // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ó–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ –ø–æ—Å–ª—É–≥—É"
            const showFormBtn = document.getElementById('show-form-btn');
            if (showFormBtn) {
                showFormBtn.addEventListener('click', showCreateForm);
            }

            // ========= –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø #4: –î–æ–¥–∞–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—é showStaticCategories() –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–µ –º—ñ—Å—Ü–µ =========
            // –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –¥–æ–¥–∞—î –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –±–µ–∑ –∑–∞–ø–∏—Ç—É –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ (—Ä–µ–∑–µ—Ä–≤–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç)
            function showStaticCategories() {
                console.log('–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ–∑–µ—Ä–≤–Ω–∏—Ö —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π');
                const categorySelect = document.getElementById('category');
                
                // –°—Ç–∞—Ç–∏—á–Ω–∏–π —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π (—è–∫ –±—É–ª–æ –≤ HTML)
                const staticCategories = [
                    {value: 'repair', name: 'üîß –†–µ–º–æ–Ω—Ç —Ç–∞ –±—É–¥—ñ–≤–Ω–∏—Ü—Ç–≤–æ'},
                    {value: 'beauty', name: 'üíÖ –ö—Ä–∞—Å–∞ —Ç–∞ –∑–¥–æ—Ä–æ–≤ º—è'},
                    {value: 'education', name: 'üìö –û—Å–≤—ñ—Ç–∞ —Ç–∞ –Ω–∞–≤—á–∞–Ω–Ω—è'},
                    {value: 'transport', name: 'üöó –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç —Ç–∞ –ø–µ—Ä–µ–≤–µ–∑–µ–Ω–Ω—è'},
                    {value: 'medicine', name: 'üè• –ú–µ–¥–∏—Ü–∏–Ω–∞ —Ç–∞ –¥–æ–≥–ª—è–¥'},
                    {value: 'food', name: 'üçï –á–∂–∞ —Ç–∞ –∫—É–ª—ñ–Ω–∞—Ä—ñ—è'},
                    {value: 'other', name: '‚ú® –†—ñ–∑–Ω—ñ –ø–æ—Å–ª—É–≥–∏'}
                ];
                
                // –î–æ–¥–∞—î–º–æ —Å—Ç–∞—Ç–∏—á–Ω—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
                staticCategories.forEach(cat => {
                    const option = document.createElement('option');
                    option.value = cat.value;
                    option.textContent = cat.name;
                    categorySelect.appendChild(option);
                });
            }
            
            // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó —Ç–∞ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
            loadCategories();
            loadServices();
        });

    </script>

<button class="btn" onclick="showStatistics()">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π</button>

<div id="statistics-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
    <div style="background: white; margin: 50px auto; padding: 20px; border-radius: 10px; max-width: 500px;">
        <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π</h3>
        <div id="statistics-content"></div>
        <button onclick="hideStatistics()" style="margin-top: 20px; padding: 10px 20px;">–ó–∞–∫—Ä–∏—Ç–∏</button>
    </div>
</div>

<script>
// ========= –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø #5: –û–Ω–æ–≤–ª–µ–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ =========
// –¶—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å —Ç–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å –¥–∞–Ω—ñ –∑—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
async function showStatistics() {
    try {
        const response = await fetch('https://tymeni-telegram-webapp-frontend.pages.dev/api/statistics');
        const data = await response.json();
        
        const modal = document.getElementById('statistics-modal');
        const content = document.getElementById('statistics-content');
        
        if (data.total_suggestions === 0) {
            content.innerHTML = '<p>–©–µ –Ω–µ–º–∞—î –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π</p>';
        } else {
            let html = `<p><strong>–í—Å—å–æ–≥–æ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–æ:</strong> ${data.total_suggestions} –∫–∞—Ç–µ–≥–æ—Ä—ñ–π</p>`;
            html += '<h4>–ü–æ–ø—É–ª—è—Ä–Ω—ñ—Å—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ–π:</h4>';
            html += '<ul style="text-align: left; max-height: 300px; overflow-y: auto;">';
            
            for (const [category, count] of Object.entries(data.categories)) {
                html += `<li><strong>${category}</strong>: ${count} –∑–∞–ø–∏—Ç(—ñ–≤)</li>`;
            }
            
            html += '</ul>';
            content.innerHTML = html;
        }
        
        modal.style.display = 'block';
        
    } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
        alert('–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É');
    }
}

function hideStatistics() {
    document.getElementById('statistics-modal').style.display = 'none';
}

// –ó–∞–∫—Ä–∏–≤–∞—Ç–∏ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ø—Ä–∏ –∫–ª—ñ–∫—É –Ω–∞ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–π —Ñ–æ–Ω
document.getElementById('statistics-modal').addEventListener('click', function(event) {
    if (event.target === this) {
        hideStatistics();
    }
});
</script>

</body>

</html>
